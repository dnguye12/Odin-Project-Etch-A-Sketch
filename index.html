<!DOCTYPE html>
<html lang="en">

<head>
    <title>Odin Project - Etch-A-Sketch</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <h1>Etch A Sketch</h1>
    <main>
        <div id="option">
            <input id="colorpicker" type="color">
            <button type="button" class="active">Color mode</button>
            <button type="button">Rainbow mode</button>
            <button type="button">Eraser</button>
            <button type="button" id="btnClear">Clear</button>
            <label for="size">16 x 16</label>
            <input id="size" type="range" min="1" max="64" value="16">
        </div>
        <table id="sketch">
    </main>
</body>
<script>
    let sketch = document.getElementById("sketch");
    sketch.style.height = sketch.style.width.toString() + "px";

    let mouseDown = false
    document.body.onmousedown = () => (mouseDown = true)
    document.body.onmouseup = () => (mouseDown = false)


    let color = "black";
    let ColorPicker = document.getElementById("colorpicker");
    ColorPicker.addEventListener("change", function () {
        color = ColorPicker.value;
        updateColor();
    });

    let style = document.createElement("style");
    document.head.appendChild(style);

    function sketchInit() {
        for (let i = 1; i <= 16; i++) {
            let row = document.createElement("tr");
            for (let j = 1; j <= 16; j++) {
                let cell = document.createElement("td");
                cell.style.height = (parseFloat(sketch.offsetHeight) / 16).toString() + "px";
                cell.style.width = (parseFloat(sketch.offsetWidth) / 16).toString() + "px";
                cell.style.border = "none";
                cell.style.padding = "0";
                cell.style.margin = "0";
                cell.classList.add("cell");
                cell.addEventListener("click", setCellColor);
                cell.addEventListener("mouseover", setCellColorHover);
                row.appendChild(cell);
            }
            row.style.padding = "0";
            row.style.margin = "0";
            sketch.appendChild(row);
        }
    }
    sketchInit();

    function setCellColor(e) {
        e.target.style.backgroundColor = color;
    }

    function setCellColorHover(e) {
        if(mouseDown) {
        e.target.style.backgroundColor = color;
        }
    }

    function updateColor() {
        let r = document.querySelector(':root');
        r.style.setProperty("--cell-color", color);
    }

    let btnClear = document.getElementById("btnClear");
    btnClear.addEventListener("click", function() {
        let cells = sketch.querySelectorAll(".cell");
        cells.forEach((cell) => {
            cell.style.backgroundColor = "white";
        } );
    } );
</script>

</html>